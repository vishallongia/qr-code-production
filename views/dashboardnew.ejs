<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Magic Code Creator</title>
    <link href="https://fonts.googleapis.com/css?family=Poppins:400,600" rel="stylesheet">
    <link href="/css/dashboardnew.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">


    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-0ZNB2G4J8G"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-0ZNB2G4J8G');
    </script>

    <!-- Standard favicon -->
    <link rel="icon" type="image/png" sizes="192x192" href="/app-icon-192.png">

    <!-- Apple Touch Icon (for iOS home screen) -->
    <link rel="apple-touch-icon" href="/app-icon-192.png">

    <!-- Android Chrome Web App Manifest (optional but useful for PWAs) -->
    <link rel="manifest" href="/manifest.json">


    <link rel="manifest" href="/manifest.json">

    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function () {
                navigator.serviceWorker.register('/service-worker.js');
            });
        }
    </script>

</head>

<body>
    <div class="container-custom">
        <div class="loader-overlay" id="loader">
            <div class="spinner"></div>
        </div>
        <!-- Popup HTML -->
        <div id="theme-popup-activate-qr" class="popup-overlay" style="display: none;">

            <div class="popup-content" style="position: relative;">
                <span id="close-popup-btn-activate-qr" style="
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: 20px;
      cursor: pointer;
      font-weight: bold;
    ">&times;</span>

                <p>This is a themed popup messages!</p>
                <form>
                    <div class="form-group" style="margin-bottom: 24px;">
                        <!-- <label>Enter Magic Code Name</label> -->
                        <input type="text" id="coupon-code-15" placeholder="Enter Coupon Code">
                    </div>
                    <button id="popup-ok-btn">Activate</button>
                </form>
            </div>
        </div>

        <div id="theme-popup-add-coupon" class="popup-overlay" style="display: none;">
            <div class="popup-content" style="position: relative;">
                <span id="close-popup" style="
                    position: absolute;
                    top: 10px;
                    right: 15px;
                    font-size: 25px;
                    cursor: pointer;
                ">&times;</span>
                <p>Please Enter Coupon Code</p>
                <form>
                    <div class="form-group" style="margin-bottom: 24px;">
                        <!-- <label>Enter Magic Code Name</label> -->
                        <input type="text" id="coupon-code-value" placeholder="Enter Coupon Code....">
                    </div>
                    <button id="popup-ok-btn-add-coupon">Add Coupon</button>
                </form>
            </div>
        </div>

        <div id="theme-popup-view-plans" class="popup-overlay" style="display: none;">
            <div class="popup-content">
                <p>You dont have any active plan.Press ok to go to subscription plan</p>


                <button id="popup-ok-btn" onclick="window.location.href='/plans'">ok</button>

            </div>
        </div>
        <!-- Header -->
        <header class="header">
            <% const isVip=user?.subscription?.isVip; const validTill=new Date(user?.subscription?.validTill); const
                now=new Date(); const isValidVip=isVip && validTill>= now;
                %>

                <div class="logo-container">
                    <% if (isValidVip) { %>
                        <img class="logo" alt="Logo" src="/VIP2.png">
                        <% } else { %>
                            <img class="logo" alt="Logo" src="/Site-main-logo.png">
                            <% } %>
                                <div class="company-name" style="margin-top: 10px;">
                                    <span class="company-name-text"
                                        style=" font-weight: bold; font-size: 18px; margin-right: 10px;">
                                        Magic Code
                                    </span>
                                    <span>
                                        <%= user?.fullName || user?.name || "Guest User" %>
                                    </span>
                                    <a href="/myprofile"
                                        style="text-decoration: none; color: inherit; display: inline-flex; align-items: center;">
                                        <svg width="18" height="18" viewBox="0 0 24 24" style="margin-left: 6px;">
                                            <path fill="black" d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 
            7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 
            0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"></path>
                                        </svg>
                                    </a>

                                </div>
                </div>
                <div class="top-right-options">
                    <div class="language-select-wrapper">
                        <select id="languageSwitcher" class="language-selector-select">
                            <option value="en">English</option>
                            <option value="de">Deutsch (German)</option>
                        </select>
                    </div>
                </div>
                <div class="hamburger" onclick="toggleSidebar()">
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
        </header>

        <!-- hidden input values -->
        <div class="input-group" style="display: none;">
            <label for="qr-color" id="CodeColorLang">Code Color:</label>
            <input type="color" id="qr-color" value="#000000">
        </div>
        <div class="input-group" style="display: none;">
            <label for="bg-color" id="BackgroundColorLang">Background
                Color:</label>
            <input type="color" id="bg-color" value="#ffffff">
        </div>
        <div class="input-group" style="display: none;">
            <label for="qr-code-key">Code</label>
            <input type="text" id="qr-code-key" placeholder="Code">
        </div>

        <div class="input-group" style="display: none;">
            <label for="qr-code-key">Code</label>
            <input type="text" id="qr-code-key" placeholder="Code">
        </div>
        <input type="hidden" id="activatedUntil">
        <div class="input-group" style="display: none;">
            <label for="qr-color" id="CodeColorLang">Code Color:</label>
            <input type="color" id="qr-color" value="#000000">
        </div>
        <div class="input-group" style="display: none;">
            <label for="dot-style">Dot Style:</label>
            <select id="dot-style">
                <option value="square">Square</option>
                <option value="rounded" selected>Rounded</option>
                <option value="dots">Dots</option>
                <option value="classy">Classy</option>
                <option value="hexagon">Hexagon</option>
                <option value="star">Star</option>
                <option value="circle">Circle</option>
            </select>
        </div>

        <div class="input-group" style="display: none;">
            <label for="corner-style">Corner Style:</label>
            <select id="corner-style">
                <option value="square">Square</option>
                <option value="dot" selected>Dot</option>
                <option value="extra-rounded">Extra Rounded</option>
                <option value="triangle">Triangle</option>
                <option value="diamond">Diamond</option>
            </select>
        </div>
        <div class="input-group" style="display: none;">
            <label for="gradient">Apply Gradient:</label>
            <select id="gradient">
                <option value="none">None</option>
                <option value="linear">Linear</option>
                <option value="radial">Radial</option>
            </select>
        </div>
        <div class="input-group" style="display: none;">
            <label for="logo" id="AddLogoLang">Logo hinzuf√ºgen
                (optional):</label>
            <input type="file" id="logo" accept="image/*">
        </div>

        <div class="input-group" style="display: none;">
            <label for="qr-text">Text or URL:</label>
            <input type="text" id="qr-text" placeholder="Enter text or URL">
        </div>

        <div class="input-group" style="display: none;">
            <label for="qr-type" id="QRLogoLabel">Logo</label>
            <select id="QRLogo">
                <option value="1">Logo1</option>
                <option value="2">Logo2</option>
                <option value="3">Logo3</option>
            </select>
        </div>


        <div class="main-container">
            <!-- Sidebar -->
            <aside class="sidebar">
                <nav class="nav-menu">
                    <% if (user.role==='affiliate' ) { %>
                        <button class="nav-item-custom active" data-link="/sales">
                            <img src="/icons-create-1.png" alt="Create icon">
                            <span>Sales</span>
                        </button>
                        <button class="nav-item-custom" data-link="/walletstatus">
                            <img src="/icons-create-1-1.png" alt="My codes icon">
                            <span>Wallet</span>
                        </button>
                        <button class="nav-item-custom" data-link="/coupons">
                            <img src="/icons-create-1-2.png" alt="Profile icon">
                            <span>Coupon Codes</span>
                        </button>

                        <button class="nav-item-custom" data-link="/color-qr">
                            <img src="/images/MyMagicStickers.png" alt="Subscription icon">
                            <span>My Magic Stickers</span>
                        </button>

                        <button class="nav-item-custom" data-link="/magiccode">
                            <img src="/images/MyMagicCodes.png" alt="My codes icon">
                            <span>My MAGIC CODEs</span>
                        </button>

                        <button class="nav-item-custom active" data-link="/dashboard">
                            <img src="/images/CreateMagicCodes.png" alt="Create icon">
                            <span>Create MAGIC CODE</span>
                        </button>

                        <button class="nav-item-custom" data-link="/myprofile">
                            <img src="/images/MyProfile.png" alt="Profile icon">
                            <span>My Profile</span>
                        </button>
                        <button class="nav-item-custom" data-link="/usercontrol">
                            <img src="/images/MagicCodeControl.png" alt="Scan icon">
                            <span>Magic Code Control</span>
                        </button>
                        <button class="nav-item-custom" data-link="#" id="installBtn">
                            <img src="/images/INSTALLAPP.png" alt="Install App icon">
                            <span>Install App</span>
                        </button>
                        <button class="nav-item-custom" data-link="/plans">
                            <img src="/images/SUBSCRIPTION.png" alt="Subscription icon">
                            <span>Subscription</span>
                        </button>
                        <button class="nav-item-custom" data-link="/magic-coin-wallet">
                            <img src="/images/SUBSCRIPTION.png" alt="Subscription icon">
                            <span>Magic Coin Wallet</span>
                        </button>
                        <% } else { %>

                            <button class="nav-item-custom" data-link="/color-qr">
                                <img src="/images/MyMagicStickers.png" alt="My Magic Stickers">
                                <span>My Magic Stickers</span>
                            </button>

                            <button class="nav-item-custom" data-link="/magiccode">
                                <img src="/images/MyMagicCodes.png" alt="My codes icon">
                                <span>My MAGIC CODEs</span>
                            </button>
                            <button class="nav-item-custom active" data-link="/dashboard">
                                <img src="/images/CreateMagicCodes.png" alt="Create icon">
                                <span>Create MAGIC CODE</span>
                            </button>
                            <button class="nav-item-custom" data-link="/myprofile">
                                <img src="/images/MyProfile.png" alt="Profile icon">
                                <span>My Profile</span>
                            </button>
                            <button class="nav-item-custom" data-link="/usercontrol">
                                <img src="/images/MagicCodeControl.png" alt="Scan icon">
                                <span>Magic Code Control</span>
                            </button>
                            <button class="nav-item-custom" data-link="#" id="installBtn">
                                <img src="/images/INSTALLAPP.png" alt="Install App icon">
                                <span>Install App</span>
                            </button>
                            <button class="nav-item-custom" data-link="/plans">
                                <img src="/images/SUBSCRIPTION.png" alt="Subscription icon">
                                <span>Subscription</span>
                            </button>
                            <button class="nav-item-custom" data-link="/magic-coin-wallet">
                                <img src="/images/SUBSCRIPTION.png" alt="Subscription icon">
                                <span>Magic Coin Wallet</span>
                            </button>

                            <% } %>
                </nav>

                <button class="logout-btn" onclick="return handleLogout(event)">
                    <img src="/vuesax-linear-logout.svg" alt="Logout icon">
                    <span>Log Out</span>
                </button>
            </aside>


            <!-- <script>
                let deferredPrompt = null;
                const installBtn = document.getElementById('installBtn');

                // Always show the install button
                installBtn.style.display = 'flex';

                // Catch the prompt and store it
                window.addEventListener('beforeinstallprompt', (e) => {
                    e.preventDefault();
                    deferredPrompt = e;
                });

                // Handle install button click
                installBtn.addEventListener('click', () => {
                    if (deferredPrompt) {
                        deferredPrompt.prompt();
                        deferredPrompt.userChoice.then((choiceResult) => {
                            if (choiceResult.outcome === 'accepted') {
                                console.log('User accepted the install');
                            } else {
                                console.log('User dismissed the install');
                            }
                            deferredPrompt = null;
                        });
                    } else {
                        alert('App is already installed or not installable at this time.');
                    }
                });
            </script> -->

            <script>
                let deferredPrompt = null;
                const installBtn = document.getElementById('installBtn');

                // Hide the install button by default
                installBtn.style.display = 'none';

                // Catch the prompt and store it
                window.addEventListener('beforeinstallprompt', (e) => {
                    e.preventDefault();
                    deferredPrompt = e;

                    // Show the install button once the event is triggered
                    installBtn.style.display = 'flex';
                });

                // Handle install button click
                installBtn.addEventListener('click', () => {
                    if (deferredPrompt) {
                        deferredPrompt.prompt();
                        deferredPrompt.userChoice.then((choiceResult) => {
                            if (choiceResult.outcome === 'accepted') {
                                console.log('User accepted the install');
                            } else {
                                console.log('User dismissed the install');
                            }
                            deferredPrompt = null;
                            installBtn.style.display = 'none'; // Optionally hide the button after interaction
                        });
                    } else {
                        alert('App is already installed or not installable at this time.');
                    }
                });
            </script>


            <% if (activeSection==='show' ) { %>
                <!-- Include the header partial -->
                <div id="show-section" class="fade-in">
                    <%- include('../components/qr-gallery-new'); -%>
                </div>
                <% } %>
                 <% if (activeSection==='magic-coin' ) { %>
                <!-- Include the header partial -->
                <div id="show-section" class="fade-in" style="width: 100%;">
                    <%- include('../components/magic-coin'); -%>
                </div>
                <% } %>
                

                    <% if (activeSection==='authenticateqr' ) { %>
                        <!-- Include the header partial -->
                        <div id="show-section" class="fade-in">
                            <%- include('../components/authenticateqr'); -%>
                        </div>
                        <% } %>
                            <% if (activeSection==='special-offer-info' ) { %>
                                <!-- Include the header partial -->
                                <div id="show-section" class="fade-in">
                                    <%- include('../components/special-offer-info'); -%>
                                </div>
                                <% } %>

                                    <% if (activeSection==='special-offer-info-page' ) { %>
                                        <!-- Include the header partial -->
                                        <div id="show-section" class="fade-in" style="width: 100%;">
                                            <%- include('../components/special-offer-info-page'); -%>
                                        </div>
                                        <% } %>

                                            <% if (activeSection==='profile' ) { %>
                                                <!-- Include the header partial -->
                                                <div id="show-section" class="fade-in">
                                                    <%- include('../components/profile-new'); -%>
                                                </div>
                                                <% } %>


                                                    <% if (activeSection==='plans' ) { %>
                                                        <!-- Include the header partial -->
                                                        <div id="show-section-plans" class="fade-in">
                                                            <%- include('../components/plans'); -%>
                                                        </div>
                                                        <% } %>

                                                            <% if (activeSection==='scanner' ) { %>
                                                                <!-- Include the header partial -->
                                                                <div id="show-section-plans" class="fade-in">
                                                                    <%- include('../components/scanner'); -%>
                                                                </div>
                                                                <% } %>

                                                                    <% if (activeSection==='colors-qr' ) { %>
                                                                        <!-- Include the header partial -->
                                                                        <div id="show-section-plans" class="fade-in">
                                                                            <%- include('../components/colors-qr'); -%>
                                                                        </div>
                                                                        <% } %>

                                                                            <% if (activeSection==='sales' ) { %>
                                                                                <!-- Include the header partial -->
                                                                                <div id="show-section-plans"
                                                                                    class="fade-in">
                                                                                    <%- include('../components/sales',{
                                                                                        usedByUsers: usedByUsers,
                                                                                        totalUsedUsers: totalUsedUsers,
                                                                                        currentPage: currentPage,
                                                                                        totalPages:
                                                                                        totalPages,totalUsedUsersWithoutPagination});
                                                                                        -%>
                                                                                </div>
                                                                                <% } %>

                                                                                    <% if (activeSection==='wallet' ) {
                                                                                        %>
                                                                                        <!-- Include the header partial -->
                                                                                        <div id="show-section-plans"
                                                                                            class="fade-in">
                                                                                            <%- include('../components/wallet',{totalCommissionBalance,user,transactionHistory
                                                                                                }); -%>
                                                                                        </div>
                                                                                        <% } %>

                                                                                            <% if
                                                                                                (activeSection==='coupon'
                                                                                                ) { %>
                                                                                                <!-- Include the header partial -->
                                                                                                <div id="show-section-plans"
                                                                                                    class="fade-in">
                                                                                                    <%- include('../components/coupon.ejs',{
                                                                                                        user: user,
                                                                                                        coupons:
                                                                                                        coupons,
                                                                                                        currentPage:
                                                                                                        currentPage,
                                                                                                        totalPages:
                                                                                                        totalPages,
                                                                                                        FRONTEND_URL:
                                                                                                        FRONTEND_URL,
                                                                                                        }); -%>
                                                                                                </div>
                                                                                                <% } %>




                                                                                                    <% if
                                                                                                        (activeSection==='usercontrol'
                                                                                                        ) { %>
                                                                                                        <!-- Include the header partial -->
                                                                                                        <div id="show-section"
                                                                                                            class="fade-in">
                                                                                                            <%- include('../components/usercontrolnew');
                                                                                                                -%>
                                                                                                        </div>
                                                                                                        <% } %>
                                                                                                            <!-- Main Content -->
                                                                                                            <% if
                                                                                                                (activeSection==='generate'
                                                                                                                ) { %>

                                                                                                                <div id="show-section-create-qr"
                                                                                                                    class="fade-in">
                                                                                                                    <div>
                                                                                                                        <span
                                                                                                                            style="font-family: Poppins;
                                            font-weight: 600;
                                            font-size: 20px;
                                            line-height: 20px;">Create Magic Code</span>
                                                                                                                    </div>

                                                                                                                    <div class="new-section-qr"
                                                                                                                        id="new-section-qr">

                                                                                                                        <!-- <div class="header-custom">Create New Magic Code</div> -->
                                                                                                                        <div
                                                                                                                            class="form-group">
                                                                                                                            <!-- <label>MAGIC CODE Name</label> -->
                                                                                                                            <input
                                                                                                                                type="text"
                                                                                                                                id="qr-name"
                                                                                                                                placeholder="Add magic code name..."
                                                                                                                                style="border: none; text-align: center;">
                                                                                                                        </div>

                                                                                                                        <div
                                                                                                                            class="qr-container">
                                                                                                                            <div
                                                                                                                                class="qr-icon">
                                                                                                                            </div>
                                                                                                                            <img src="/images/ICONS CREATE.png"
                                                                                                                                alt="wand"
                                                                                                                                class="wand" />

                                                                                                                        </div>
                                                                                                                        <div
                                                                                                                            style="width: 100%; display: flex; justify-content: center;">
                                                                                                                            <button
                                                                                                                                class="save-btn"
                                                                                                                                id="submit-btn-generate">Save</button>
                                                                                                                        </div>

                                                                                                                    </div>
                                                                                                                </div>
                                                                                                                <% } %>
                                                                                                                    <% if
                                                                                                                        (activeSection==='generate'
                                                                                                                        )
                                                                                                                        {
                                                                                                                        %>
                                                                                                                        <main
                                                                                                                            class="main-content"
                                                                                                                            id="generateqrsection"
                                                                                                                            style="display: none;">

                                                                                                                            <div
                                                                                                                                class="content-wrapper">
                                                                                                                                <h1>Create
                                                                                                                                    MAGIC
                                                                                                                                    CODE
                                                                                                                                </h1>

                                                                                                                                <form
                                                                                                                                    class="create-form">


                                                                                                                                    <div
                                                                                                                                        class="form-group">
                                                                                                                                        <label>MAGIC
                                                                                                                                            CODE
                                                                                                                                            Content</label>
                                                                                                                                        <select
                                                                                                                                            id="qr-type">
                                                                                                                                            <option
                                                                                                                                                id="MediaLangPhoto"
                                                                                                                                                value="media">
                                                                                                                                                Photo/Video
                                                                                                                                            </option>
                                                                                                                                            <option
                                                                                                                                                id="TextLangChoose"
                                                                                                                                                value="text"
                                                                                                                                                selected>
                                                                                                                                                Text
                                                                                                                                            </option>
                                                                                                                                            <option
                                                                                                                                                id="LinkLangChoose"
                                                                                                                                                value="url">
                                                                                                                                                Link
                                                                                                                                            </option>
                                                                                                                                        </select>
                                                                                                                                    </div>

                                                                                                                                    <div
                                                                                                                                        id="input-fields">
                                                                                                                                    </div>



                                                                                                                                    <div
                                                                                                                                        class="form-group">
                                                                                                                                        <label>Background</label>
                                                                                                                                        <div
                                                                                                                                            class="button-group">
                                                                                                                                            <button
                                                                                                                                                type="button"
                                                                                                                                                class="btn-outline active">Keep
                                                                                                                                                Background</button>
                                                                                                                                            <button
                                                                                                                                                type="button"
                                                                                                                                                class="btn-outline">Remove
                                                                                                                                                Background</button>
                                                                                                                                        </div>
                                                                                                                                    </div>



                                                                                                                                    <div
                                                                                                                                        class="form-group">
                                                                                                                                        <label>Foreground
                                                                                                                                            Color</label>
                                                                                                                                        <div
                                                                                                                                            class="color-grid">
                                                                                                                                            <!-- <div class="color-option selected">
                                    <img src="/image.png" alt="Color">
                                    <img src="/tick-circle.png" alt="Selected" class="tick">
                                </div> -->
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #000000">
                                                                                                                                            </div>
                                                                                                                                            <!-- Black -->
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #ffffff; border: 1px solid #ccc;">
                                                                                                                                            </div>
                                                                                                                                            <!-- White -->
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #d13737">
                                                                                                                                            </div>
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #c2d137">
                                                                                                                                            </div>
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #3751d1">
                                                                                                                                            </div>
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #d1376d">
                                                                                                                                            </div>
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #37d149">
                                                                                                                                            </div>
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #37c7d1">
                                                                                                                                            </div>
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #cc37d1">
                                                                                                                                            </div>
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #d16337">
                                                                                                                                            </div>
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #5137d1">
                                                                                                                                            </div>
                                                                                                                                        </div>
                                                                                                                                    </div>

                                                                                                                                    <div
                                                                                                                                        class="form-group">
                                                                                                                                        <label>Background
                                                                                                                                            Color</label>
                                                                                                                                        <div
                                                                                                                                            class="color-grid">
                                                                                                                                            <!-- <div class="color-option selected">
                                    <img src="/image-2.png" alt="Color">
                                    <img src="/tick-circle-1.png" alt="Selected" class="tick">
                                </div> -->
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #000000">
                                                                                                                                            </div>
                                                                                                                                            <!-- Black -->
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #ffffff; border: 1px solid #ccc;">
                                                                                                                                            </div>
                                                                                                                                            <!-- White -->
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #d13737">
                                                                                                                                            </div>
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #c2d137">
                                                                                                                                            </div>
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #3751d1">
                                                                                                                                            </div>
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #d1376d">
                                                                                                                                            </div>
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #37d149">
                                                                                                                                            </div>
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #37c7d1">
                                                                                                                                            </div>
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #cc37d1">
                                                                                                                                            </div>
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #d16337">
                                                                                                                                            </div>
                                                                                                                                            <div class="color-option"
                                                                                                                                                style="background-color: #5137d1">
                                                                                                                                            </div>
                                                                                                                                        </div>
                                                                                                                                    </div>

                                                                                                                                    <div
                                                                                                                                        class="action-buttons">
                                                                                                                                        <button
                                                                                                                                            type="button"
                                                                                                                                            class="btn-outline active submit-btn">
                                                                                                                                            <img src="/icons-create-1-4.png"
                                                                                                                                                alt="Create icon">
                                                                                                                                            Create
                                                                                                                                            MAGIC
                                                                                                                                            CODE
                                                                                                                                        </button>
                                                                                                                                        <button
                                                                                                                                            type="button"
                                                                                                                                            class="btn-outline"
                                                                                                                                            id="PrintMyQR"
                                                                                                                                            style="display: none;">
                                                                                                                                            <img src="/icons-create-1-5.png"
                                                                                                                                                alt="Print icon">
                                                                                                                                            Print
                                                                                                                                            Magic
                                                                                                                                            Code
                                                                                                                                        </button>
                                                                                                                                    </div>
                                                                                                                                </form>
                                                                                                                            </div>
                                                                                                                        </main>
                                                                                                                        <% }
                                                                                                                            %>

                                                                                                                            <% if
                                                                                                                                (activeSection==='update'
                                                                                                                                )
                                                                                                                                {
                                                                                                                                %>
                                                                                                                                <div id="show-section"
                                                                                                                                    class="fade-in">
                                                                                                                                    <div class="form-group"
                                                                                                                                        style="display: none;">
                                                                                                                                        <label>MAGIC
                                                                                                                                            CODE
                                                                                                                                            Name</label>
                                                                                                                                        <input
                                                                                                                                            type="text"
                                                                                                                                            id="qr-name"
                                                                                                                                            placeholder="Enter MAGIC CODE name...">
                                                                                                                                    </div>
                                                                                                                                    <div class="form-group"
                                                                                                                                        style="display: none;">
                                                                                                                                        <label>MAGIC
                                                                                                                                            CODE
                                                                                                                                            Content</label>
                                                                                                                                        <select
                                                                                                                                            id="qr-type">
                                                                                                                                            <option
                                                                                                                                                id="MediaLangPhoto"
                                                                                                                                                value="media">
                                                                                                                                                Photo/Video
                                                                                                                                            </option>
                                                                                                                                            <option
                                                                                                                                                id="TextLangChoose"
                                                                                                                                                value="text"
                                                                                                                                                selected>
                                                                                                                                                Text
                                                                                                                                            </option>
                                                                                                                                            <option
                                                                                                                                                id="LinkLangChoose"
                                                                                                                                                value="url">
                                                                                                                                                Link
                                                                                                                                            </option>
                                                                                                                                        </select>
                                                                                                                                    </div>
                                                                                                                                    <%- include('../components/showandupdateqr',
                                                                                                                                        {
                                                                                                                                        qrCode:
                                                                                                                                        qrCode,
                                                                                                                                        user:
                                                                                                                                        user,
                                                                                                                                        activeSection:
                                                                                                                                        activeSection
                                                                                                                                        })
                                                                                                                                        %>
                                                                                                                                        <% }
                                                                                                                                            %>


                                                                                                                                </div>
        </div>
    </div>
</body>
<script src="/js/loadertoggler.js"></script>
<script src="/js/dashboard.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastify-js/1.12.0/toastify.min.js"></script>
<script src="/js/toastify-setup.js"></script>
<script src="/js/generateqr-api.js"></script>
<script src="/js/api-calls.js"></script>
<script>
    const navItems = document.querySelectorAll(".nav-item-custom");

    // Get current actual path from the browser
    const currentPath = window.location.pathname;

    // Loop through nav items and sync active class
    navItems.forEach(item => {
        const itemPath = item.dataset.link;
        const isActive = itemPath === currentPath;
        item.classList.toggle("active", isActive);

        if (isActive) {
            localStorage.setItem("activeNavPath", itemPath); // update localStorage to keep in sync
        }

        // Add click listener
        item.addEventListener("click", () => {
            localStorage.setItem("activeNavPath", itemPath);
            window.location.href = itemPath;
        });
    });
</script>


<script>
    function toggleSidebar() {
        const sidebar = document.querySelector('.sidebar');
        sidebar.classList.toggle('active');
    }


    document.addEventListener('click', function (event) {
        const sidebar = document.querySelector('.sidebar');
        const hamburger = document.querySelector('.hamburger');
        if (
            sidebar.classList.contains('active') &&
            !sidebar.contains(event.target) &&
            !hamburger.contains(event.target)
        ) {
            sidebar.classList.remove('active');
        }
    });
    function updateLanguageOptions() {
        const isMobile = window.innerWidth <= 768;
        const languageSelect = document.getElementById('languageSwitcher');
        if (languageSelect) {
            languageSelect.options[0].text = isMobile ? 'En' : 'English';
            languageSelect.options[1].text = isMobile ? 'De' : 'Deutsch (German)';
        }
    }

    // Run on page load
    window.addEventListener('load', updateLanguageOptions);

    // Run on window resize
    window.addEventListener('resize', updateLanguageOptions);
</script>
<script>
    const langSelector = document.querySelector('.language-selector');
    const selectedLang = document.querySelector('.selected-lang');
    const dropdownItems = document.querySelectorAll('.language-dropdown li');

    langSelector.addEventListener('click', () => {
        langSelector.classList.toggle('active');
    });

    dropdownItems.forEach(item => {
        item.addEventListener('click', (e) => {
            const lang = e.target.getAttribute('data-lang');
            selectedLang.textContent = lang;
            langSelector.classList.remove('active');
        });
    });

    // Optional: Click outside to close dropdown
    document.addEventListener('click', (e) => {
        if (!langSelector.contains(e.target)) {
            langSelector.classList.remove('active');
        }
    });
</script>
<script>
    <% if (typeof message !== 'undefined' && message && type !== 'none' && type !== 'hidden') { %>
        showToast("<%= message %>", "<%= type || 'success' %>");
<% } %>
</script>
<script src="/js/translations.js"></script>





</html>